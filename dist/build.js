var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){b!=Array.prototype&&b!=Object.prototype&&(b[c]=a.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var c=0;return $jscomp.iteratorPrototype(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=b[Symbol.iterator];return c?c.call(b):$jscomp.arrayIterator(b)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(b){var c=function(){};c.prototype=b;return new c};
$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},c={};try{return c.__proto__=b,c.a}catch(a){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null;
$jscomp.inherits=function(b,c){b.prototype=$jscomp.objectCreate(c.prototype);b.prototype.constructor=b;if($jscomp.setPrototypeOf){var a=$jscomp.setPrototypeOf;a(b,c)}else for(a in c)if("prototype"!=a)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(c,a);d&&Object.defineProperty(b,a,d)}else b[a]=c[a];b.superClass_=c.prototype};$jscomp.arrayFromIterator=function(b){for(var c,a=[];!(c=b.next()).done;)a.push(c.value);return a};
$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};$jscomp.polyfill=function(b,c,a,d){if(c){a=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in a||(a[e]={});a=a[e]}b=b[b.length-1];d=a[b];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.fill",function(b){return b?b:function(b,a,d){var c=this.length||0;0>a&&(a=Math.max(0,c+a));if(null==d||d>c)d=c;d=Number(d);0>d&&(d=Math.max(0,c+d));for(a=Number(a||0);a<d;a++)this[a]=b;return this}},"es6","es3");$jscomp.findInternal=function(b,c,a){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var f=b[e];if(c.call(a,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");var origin={x:0,y:0,z:0},Vector=function(b,c){c||(c=b,b=origin);this.x=c.x-b.x;this.y=c.y-b.y;this.z=c.z-b.z};Vector.prototype.add=function(b){return new Vector(origin,{x:this.x+b.x,y:this.y+b.y,z:this.z+b.z})};Vector.prototype.subtract=function(b){return this.add({x:-b.x,y:-b.y,z:-b.z})};
Vector.prototype.multiply=function(b){return new Vector(origin,{x:this.x*b,y:this.y*b,z:this.z*b})};Vector.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};Vector.prototype.unit=function(){return this.multiply(1/this.magnitude())};Vector.prototype.cross=function(b){return new Vector(origin,{x:this.y*b.z-this.z*b.y,y:this.z*b.x-this.x*b.z,z:this.x*b.y-this.y*b.x})};
var qDimensions=["w","x","y","z"],qProductSign=[[1,1,1,1],[1,-1,1,-1],[1,-1,-1,1],[1,1,-1,-1]],qProductAxis=[[0,1,2,3],[1,0,3,2],[2,3,0,1],[3,2,1,0]],Quaternion=function(b,c,a,d){this.w=b;this.x=c;this.y=a;this.z=d};Quaternion.prototype.conjugate=function(){return new Quaternion(this.w,-this.x,-this.y,-this.z)};
Quaternion.prototype.multiply=function(b){for(var c=new Quaternion(0,0,0,0),a=0;4>a;a++)for(var d=0;4>d;d++)c[qDimensions[qProductAxis[a][d]]]+=qProductSign[a][d]*this[qDimensions[a]]*b[qDimensions[d]];return c};var Point=function(b,c,a,d){this.base={x:b,y:c,z:a};this.x=b;this.y=c;this.z=a;this.id=d};Point.prototype.update=function(b){b=this.rotateAroundAxis(this.base,b.axis.unit(),b.angle);var c=b.y,a=b.z;this.x=b.x;this.y=c;this.z=a};
Point.prototype.saveOrientation=function(b){this.update(b);this.base.x=this.x;this.base.y=this.y;this.base.z=this.z};Point.prototype.clone=function(){return new Point(this.x,this.y,this.z,this.id)};Point.prototype.rotateAroundAxis=function(b,c,a){var d=Math.sin(a/2);c=new Quaternion(Math.cos(a/2),d*c.x,d*c.y,d*c.z);b=new Quaternion(0,b.x,b.y,b.z);b=c.multiply(b).multiply(c.conjugate());return new Point(b.x,b.y,b.z)};var Sticker=function(b,c,a){this.id=b;this.color=c;this.points=a;this.attractor={}};
Sticker.prototype.contains=function(b){for(var c=this.points[this.points.length-1],a=0,d=$jscomp.makeIterator(this.points),e=d.next();!e.done;e=d.next()){e=e.value;c=(new Vector(c,e)).cross(new Vector(c,b));if(0>a&&0<c.z||0<a&&0>c.z)return!1;0!==c.z&&(a=c.z);c=e}return!0};Sticker.prototype.calculateNormalVector=function(){return(new Vector(this.points[0],this.points[1])).cross(new Vector(this.points[0],this.points[this.points.length-1]))};
Sticker.prototype.update=function(b){this.points.forEach(function(c){return c.update(b)});this.attractor={x:this.points.reduce(function(b,a){return b+a.x},0),y:this.points.reduce(function(b,a){return b+a.y},0),z:this.points.reduce(function(b,a){return b+a.z},0)}};Sticker.prototype.getPointProjection=function(b,c,a){b=[b.x,b.y];a&&(b[0]+=(this.attractor.x-b[0])/(10*this.points.length),b[1]+=(this.attractor.y-b[1])/(10*this.points.length));c&&(b[0]=-b[0]);return b};
Sticker.prototype.render=function(b,c,a){var d=this;b.fillStyle=this.color;b.strokeStyle="#202020";b.beginPath();b.moveTo.apply(b,$jscomp.arrayFromIterable(this.getPointProjection(this.points[0],c,a)));this.points.forEach(function(e){return b.lineTo.apply(b,$jscomp.arrayFromIterable(d.getPointProjection(e,c,a)))});b.closePath();b.fill();b.stroke()};var Face=function(b){this.stickers=b;this.normalVector=this.stickers[0].calculateNormalVector()};
Face.prototype.update=function(b){this.stickers.forEach(function(c){return c.update(b)});this.normalVector=this.stickers[0].calculateNormalVector()};Face.prototype.render=function(b,c,a){this.stickers.forEach(function(d){return d.render(b,c,a)})};var Cycle=function(b,c,a,d){this.stickerCollections=b;this.period=c;this.unitVector=a;this.animationConfig=d;this.stickerCover={}};
Cycle.prototype.computeStickerCover=function(){var b=this;this.stickerCollections.forEach(function(c){return c.forEach(function(a){return b.stickerCover[a.id]=!0})})};Cycle.prototype.saveOrientation=function(b){var c=new Point(this.unitVector.x,this.unitVector.y,this.unitVector.z);c.update(b);this.unitVector=new Vector(c)};
Cycle.prototype.twist=function(b){var c=this;b=void 0===b?1:b;this.stickerCollections.forEach(function(a){if(1!==a.length){var d=b*a.length/c.period;a.forEach(function(b,c){b.newColor=a[mod(c-d,a.length)].color});a.forEach(function(b){b.color=b.newColor;delete b.newColor})}})};
var Puzzle=function(b,c){this.faces=b;this.cycles=c;this.twisting=this.rotating=!1;this.startEvtCoordinates={};this.baseOrientation={axis:new Vector({x:1,y:0,z:0}),angle:0};this.twistCounter=0;this.animationState={active:!1,counter:0,direction:void 0,cycle:void 0};this.stickers=[].concat.apply([],$jscomp.arrayFromIterable(this.faces.map(function(b){return b.stickers})));this.startTime=void 0;this.movesMade=0;this.cycleMap={};this.processCycleMap();this.startSticker=void 0};
Puzzle.prototype.isSolved=function(){for(var b=0;b<this.faces.length;b++)for(var c=0;c<this.faces[b].stickers.length;c++)if(this.faces[b].stickers[c].color!==this.faces[b].stickers[0].color)return!1;return!0};Puzzle.prototype.processCycleMap=function(){var b=this;this.cycles.forEach(function(c){return c.stickerCollections.forEach(function(a){a.isPrimary&&a.forEach(function(a){b.cycleMap[a.id]=b.cycleMap[a.id]||[];b.cycleMap[a.id].push(c)})})})};
Puzzle.prototype.update=function(){var b=this;if(this.animationState.active&&this.animationState.counter<this.animationState.cycle.animationConfig.steps){var c={axis:this.animationState.cycle.unitVector,angle:this.animationState.direction*this.animationState.counter*this.animationState.cycle.animationConfig.dAlpha};this.stickers.forEach(function(a){b.animationState.cycle.stickerCover[a.id]&&a.update(c)});this.stickers.sort(function(b,c){return c.attractor.z-b.attractor.z});this.animationState.counter++}else if(this.faces.forEach(function(a){return a.update(b.updatedOrientation||
b.baseOrientation)}),this.faces.sort(function(b,c){return c.normalVector.z-b.normalVector.z}),this.animationState.active){this.animationState.cycle.twist(this.animationState.direction);this.startTime&&this.isSolved()?(this.onFinish&&this.onFinish(((new Date).getTime()-this.startTime)/1E3),this.startTime=void 0,this.movesMade=0):this.startTime&&this.movesMade++;if(this.animationState.callback&&(this.animationState.callback(),this.animationState.counter<this.animationState.cycle.animationConfig.steps))return this.update();
this.animationState={active:!1,counter:0,direction:void 0,cycle:void 0}}};Puzzle.prototype.findTouchedSticker=function(b,c){for(var a,d=this.faces.length-1;0<=d&&!(0<=this.faces[d].normalVector.z);d--)if(a=this.faces[d].stickers.find(function(a){return a.contains({x:b,y:c,z:0})}))return a};Puzzle.prototype.grab=function(b,c,a){this.startEvtCoordinates.x=b;this.startEvtCoordinates.y=c;2==a?this.rotating=!0:(this.startSticker=this.findTouchedSticker(b,c),this.twisting=!!this.startSticker)};
Puzzle.prototype.drag=function(b,c){if(!this.animationState.active)if(this.rotating){if(b=(b-this.startEvtCoordinates.x)/100,c=(c-this.startEvtCoordinates.y)/100,b||c)c=new Vector({x:c,y:-b,z:0}),this.updatedOrientation={axis:c,angle:c.magnitude()}}else this.twisting&&(7>this.twistCounter?this.twistCounter++:this.detectCycle(b,c))};
Puzzle.prototype.detectCycle=function(b,c){if(this.cycleMap[this.startSticker.id]){var a=new Vector(new Point(this.startEvtCoordinates.x,this.startEvtCoordinates.y,0),new Point(b,c,0)),d=0,e,f;this.cycleMap[this.startSticker.id].forEach(function(b){var c=new Point(b.unitVector.x,b.unitVector.y,b.unitVector.z);c.z=0;c=(new Vector(c)).unit();c=a.cross(c);d<c.magnitude()&&(d=c.magnitude(),e=b,f=0<c.z?-1:1)});this.animationState={active:!0,counter:0,direction:f,cycle:e};this.release()}};
Puzzle.prototype.release=function(){this.twisting=this.rotating=!1;this.startEvtCoordinates={};this.updatedOrientation&&(this.saveOrientation(this.updatedOrientation),this.updatedOrientation=void 0);this.twistCounter=0;this.startSticker=void 0};Puzzle.prototype.saveOrientation=function(b){this.stickers.forEach(function(c){return c.points.forEach(function(c){return c.saveOrientation(b)})});this.cycles.forEach(function(c){return c.saveOrientation(b)})};
Puzzle.prototype.scramble=function(){for(var b=this,c=3*this.cycles.length,a=[],d=0;d<c;d++)a.push({cycle:this.cycles[Math.floor(Math.random()*this.cycles.length)],direction:.5>Math.random()?-1:1});var e=[];a.forEach(function(d,h){var f=d.cycle;d=d.direction;h&&f===a[h-1].cycle&&(d=a[h-1].direction);e.push({active:!0,counter:0,direction:d,cycle:f,callback:h<c-1?function(){return b.animationState=e[h+1]}:function(){return b.startTime=(new Date).getTime()}})});this.animationState=e[0]};
Puzzle.prototype.render=function(b,c,a){a=void 0===a?!0:a;if(this.animationState.active){var d=$jscomp.makeIterator(c?[this.stickers.length-1,-1,-1]:[0,this.stickers.length,1]),e=d.next().value,f=d.next().value;for(d=d.next().value;e!==f;e+=d)this.stickers[e].render(b,c,a)}else for(d=$jscomp.makeIterator(c?[this.faces.length-1,-1,-1]:[0,this.faces.length,1]),e=d.next().value,f=d.next().value,d=d.next().value;e!==f;e+=d)this.faces[e].render(b,c,a)};
var Cube=function(b,c){b=void 0===b?2:b;c=void 0===c?250:c;var a=c/b,d=c/2,e={steps:10,dAlpha:Math.PI/2/10},f={},h=[];c=[{slices:[{fIndex:1,sIndex:0,sJump:b,cJump:1},{fIndex:3,sIndex:b-1,sJump:-1,cJump:b},{fIndex:0,sIndex:(b-1)*b,sJump:-b,cJump:1},{fIndex:2,sIndex:0,sJump:1,cJump:b}],attachedFaces:{ffIndex:4,lfIndex:5,iStep:b,jStep:1},unitVector:new Vector(new Point(0,0,1))},{slices:[{fIndex:1,sIndex:0,sJump:1,cJump:b},{fIndex:5,sIndex:(b-1)*b,sJump:-b,cJump:1},{fIndex:0,sIndex:b-1,sJump:-1,cJump:b},
{fIndex:4,sIndex:0,sJump:b,cJump:1}],attachedFaces:{ffIndex:2,lfIndex:3,iStep:1,jStep:b},unitVector:new Vector(new Point(0,-1,0))},{slices:[{fIndex:2,sIndex:0,sJump:b,cJump:1},{fIndex:5,sIndex:0,sJump:1,cJump:b},{fIndex:3,sIndex:(b-1)*b,sJump:-b,cJump:1},{fIndex:4,sIndex:b-1,sJump:-1,cJump:b}],attachedFaces:{ffIndex:0,lfIndex:1,iStep:1,jStep:b},unitVector:new Vector(new Point(-1,0,0))}];var l=[{key:"iStep",dir:1},{key:"jStep",dir:1},{key:"iStep",dir:-1},{key:"jStep",dir:-1}],w,m,n,u,x,v;[{fixed:"x",
direction:-1,variable:["y","z"],color:"yellow"},{fixed:"x",direction:1,variable:["y","z"],color:"white"},{fixed:"y",direction:-1,variable:["z","x"],color:"blue"},{fixed:"y",direction:1,variable:["z","x"],color:"lawngreen"},{fixed:"z",direction:-1,variable:["x","y"],color:"red"},{fixed:"z",direction:1,variable:["x","y"],color:"darkorange"}].forEach(function(c,g){var t=[];w=-d;for(var e=0;e<=b;e++){m=-d;for(var k=0;k<=b;k++)u="p-"+g+"-"+e+"-"+k,n={},n[c.fixed]=c.direction*d,n[c.variable[0]]=w,n[c.variable[1]]=
m,f[u]=new Point(n.x,n.y,n.z,u),e&&k&&(x="s-"+g+"-"+e+"-"+k,v=[f["p-"+g+"-"+e+"-"+k].clone(),f["p-"+g+"-"+(e-1)+"-"+k].clone(),f["p-"+g+"-"+(e-1)+"-"+(k-1)].clone(),f["p-"+g+"-"+e+"-"+(k-1)].clone()],-1===c.direction&&v.reverse(),t.push(new Sticker(x,c.color,v))),m+=a;w+=a}h.push(new Face(t))});var y=[],g,t,r,A,p,q,z;c.forEach(function(c){for(var a={c:0};a.c<b;a={c:a.c},a.c++)g=new Cycle([],4,c.unitVector,e),t=[],c.slices.forEach(function(c){return function(a){for(var g=0;g<b;g++)r=a.sIndex+g*a.sJump+
c.c*a.cJump,t.push(h[a.fIndex].stickers[r])}}(a)),g.stickerCollections.push(t),y.push(g);A=y[y.length-b];q=h[c.attachedFaces.ffIndex];for(a={c$4:0};a.c$4<Math.floor(b/2);a={c$4:a.c$4},a.c$4++)t=[],r=a.c$4*(b+1),l.forEach(function(a){return function(g){var d=g.key;g=g.dir;for(var e=0;e<b-2*a.c$4-1;e++)t.push(q.stickers[r]),r+=c.attachedFaces[d]*g}}(a)),A.stickerCollections.push(t);p=y[y.length-1];z=h[c.attachedFaces.lfIndex];for(a={c$5:0};a.c$5<Math.floor(b/2);a={c$5:a.c$5},a.c$5++)t=[],r=a.c$5*(b+
1),l.forEach(function(a){return function(g){var d=g.key;g=g.dir;for(var e=0;e<b-2*a.c$5-1;e++)t.push(z.stickers[r]),r+=c.attachedFaces[d]*g}}(a)),p.stickerCollections.push(t);b%2&&(A.stickerCollections.push([q.stickers[(b*b-1)/2]]),p.stickerCollections.push([z.stickers[(b*b-1)/2]]))});y.forEach(function(b){b.stickerCollections[0].isPrimary=!0;b.computeStickerCover()});Puzzle.call(this,h,y);this.saveOrientation({axis:new Vector({x:0,y:1,z:0}),angle:Math.PI/4});this.saveOrientation({axis:new Vector({x:1,
y:0,z:0}),angle:Math.PI/8})};$jscomp.inherits(Cube,Puzzle);
var Tetrahedron=function(b,c){b=void 0===b?3:b;c=void 0===c?200:c;var a=c/Math.sqrt(2),d={steps:10,dAlpha:2*Math.PI/3/10},e={},f=[],h=[];a=[new Point(c,0,a),new Point(-c,0,a),new Point(0,c,-a),new Point(0,-c,-a)];c=[{points:[a[0],a[2],a[1]],color:"white"},{points:[a[0],a[1],a[3]],color:"blue"},{points:[a[0],a[3],a[2]],color:"lawngreen"},{points:[a[1],a[2],a[3]],color:"red"}];a=[{slices:[{fIndex:0,sIJ:function(b){return[b,0]},dIJ:function(){return[0,1]}},{fIndex:1,sIJ:function(b){return[b,0]},dIJ:function(){return[0,
1]}},{fIndex:2,sIJ:function(b){return[b,0]},dIJ:function(){return[0,1]}}],attachedFace:{fIndex:3,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(a[0])).unit()},{slices:[{fIndex:0,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]}},{fIndex:3,sIJ:function(b){return[b,0]},dIJ:function(){return[0,1]}},{fIndex:1,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]}}],attachedFace:{fIndex:2,steps:[function(){return[1,
2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(a[1])).unit()},{slices:[{fIndex:0,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]}},{fIndex:2,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]}},{fIndex:3,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]}}],attachedFace:{fIndex:1,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(a[2])).unit()},
{slices:[{fIndex:1,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]}},{fIndex:3,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]}},{fIndex:2,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]}}],attachedFace:{fIndex:0,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(a[3])).unit()}];c.forEach(function(a,c){for(var g=[],d=[a.points[0].clone()],A,p,q,z,B,
k=(new Vector(a.points[0],a.points[1])).multiply(1/b),h=(new Vector(a.points[1],a.points[2])).multiply(1/b),l,m={i:0};m.i<b;m={i:m.i},m.i++){A=[];l=k.add(d[0]);A.push(new Point(l.x,l.y,l.z));for(var n=0;n<=m.i;n++)l=h.add(l),A.push(new Point(l.x,l.y,l.z));d.forEach(function(b){return function(t,k){p=t.clone();q=A[k].clone();z=A[k+1].clone();p.id="p-"+c+"-"+b.i+"-"+k;q.id="p-"+c+"-"+(b.i+1)+"-"+k;z.id="p-"+c+"-"+(b.i+1)+"-"+(k+1);p.clone();q.clone();z.clone();g.push(new Sticker("s-"+c+"-"+b.i+"-"+
2*k,a.color,[p,q,z]));e[g[g.length-1].id]=g[g.length-1];k<d.length-1&&(p=p.clone(),z=z.clone(),B=d[k+1].clone(),B.id="q-"+c+"-"+b.i+"-"+(k+1),p.clone(),z.clone(),B.clone(),g.push(new Sticker("s-"+c+"-"+b.i+"-"+(2*k+1),a.color,[p,z,B])),e[g[g.length-1].id]=g[g.length-1])}}(m));d=A}f.push(new Face(g))});var l,w,m,n,u,x,v;a.forEach(function(a){for(var c={c:0};c.c<b;c={c:c.c},c.c++)l=new Cycle([],3,a.unitVector,d),m=[],a.slices.forEach(function(b){return function(a){var c=$jscomp.makeIterator(a.sIJ(b.c));
n=c.next().value;u=c.next().value;for(c=0;c<1+2*b.c;c++){var g=$jscomp.makeIterator(a.dIJ(b.c,c));x=g.next().value;v=g.next().value;m.push(e["s-"+a.fIndex+"-"+n+"-"+u]);n+=x;u+=v}}}(c)),l.stickerCollections.push(m),h.push(l);l=h[h.length-1];w=a.attachedFace.fIndex;var t=b-1;c=1;for(var r=0,f,p,q;0<t;)p=q=r,m=[],a.attachedFace.steps.forEach(function(b){for(var a=f=0;a<t;a++){var c=$jscomp.makeIterator(b(r,f)),g=c.next().value;c=c.next().value;m.push(e["s-"+w+"-"+p+"-"+q]);p+=g;q+=c;f+=1}}),l.stickerCollections.push(m),
r+=1,t-=c,c=2===c?1:2;e["s-"+w+"-"+r+"-"+r]&&l.stickerCollections.push([e["s-"+w+"-"+r+"-"+r]])});h.forEach(function(b){b.stickerCollections[0].isPrimary=!0;b.computeStickerCover()});Puzzle.call(this,f,h);this.saveOrientation({axis:new Vector({x:0,y:1,z:0}),angle:Math.PI/3})};$jscomp.inherits(Tetrahedron,Puzzle);
var Octahedron=function(b,c){b=void 0===b?2:b;c=void 0===c?200:c;var a={steps:10,dAlpha:2*Math.PI/3/10},d={},e=[],f=[];c=[new Point(0,0,-c),new Point(c,0,0),new Point(0,c,0),new Point(-c,0,0),new Point(0,-c,0),new Point(0,0,c)];c=[{points:[c[0],c[2],c[1]],color:"white"},{points:[c[0],c[1],c[4]],color:"blue"},{points:[c[0],c[4],c[3]],color:"lawngreen"},{points:[c[0],c[3],c[2]],color:"skyblue"},{points:[c[5],c[1],c[2]],color:"red"},{points:[c[5],c[2],c[3]],color:"darkorange"},{points:[c[5],c[3],c[4]],
color:"purple"},{points:[c[5],c[4],c[1]],color:"yellow"}];var h=[{slices:[{fIndex:4,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(){return[0,-1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:7,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]},limJ:function(b){return 1+2*b}},{fIndex:1,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,a%2?-1:1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:2,sIJ:function(b){return[b,0]},dIJ:function(){return[0,
1]},limJ:function(b){return 1+2*b}},{fIndex:3,sIJ:function(b){return[b,0]},dIJ:function(b,a){return[a%2?0:1,1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:5,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]},limJ:function(b){return 1+2*b}}],attachedFaces:[{fIndex:0,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:6,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(1,
1,-1))).unit()},{slices:[{fIndex:0,sIJ:function(b){return[b,0]},dIJ:function(b,a){return[a%2?0:1,1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:4,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]},limJ:function(b){return 1+2*b}},{fIndex:7,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(){return[0,-1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:6,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]},limJ:function(b){return 1+2*b}},{fIndex:2,
sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,a%2?-1:1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:3,sIJ:function(b){return[b,0]},dIJ:function(){return[0,1]},limJ:function(b){return 1+2*b}}],attachedFaces:[{fIndex:1,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:5,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(1,-1,-1))).unit()},{slices:[{fIndex:1,sIJ:function(b){return[b,
0]},dIJ:function(b,a){return[a%2?0:1,1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:7,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]},limJ:function(b){return 1+2*b}},{fIndex:6,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(){return[0,-1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:5,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]},limJ:function(b){return 1+2*b}},{fIndex:3,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%
2?-1:0,a%2?-1:1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:0,sIJ:function(b){return[b,0]},dIJ:function(){return[0,1]},limJ:function(b){return 1+2*b}}],attachedFaces:[{fIndex:2,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:4,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(-1,-1,-1))).unit()},{slices:[{fIndex:2,sIJ:function(b){return[b,0]},dIJ:function(b,a){return[a%2?0:1,1]},limJ:function(a){return 1+
2*(b-a-1)}},{fIndex:6,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,-1]},limJ:function(b){return 1+2*b}},{fIndex:5,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(){return[0,-1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:4,sIJ:function(a){return[b-a-1,2*(b-a-1)]},dIJ:function(b,a){return[a%2?0:1,a%2?-1:1]},limJ:function(b){return 1+2*b}},{fIndex:0,sIJ:function(a){return[b-1,2*a]},dIJ:function(b,a){return[a%2?-1:0,a%2?-1:1]},limJ:function(a){return 1+2*(b-a-1)}},{fIndex:1,
sIJ:function(b){return[b,0]},dIJ:function(){return[0,1]},limJ:function(b){return 1+2*b}}],attachedFaces:[{fIndex:3,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:7,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(-1,1,-1))).unit()}];c.forEach(function(a,c){for(var f=[],t=[a.points[0].clone()],p,q,g,h,k,l=(new Vector(a.points[0],a.points[1])).multiply(1/b),m=(new Vector(a.points[1],a.points[2])).multiply(1/
b),n,u={i:0};u.i<b;u={i:u.i},u.i++){p=[];n=l.add(t[0]);p.push(new Point(n.x,n.y,n.z));for(var v=0;v<=u.i;v++)n=m.add(n),p.push(new Point(n.x,n.y,n.z));t.forEach(function(b){return function(e,r){q=e.clone();g=p[r].clone();h=p[r+1].clone();q.id="p-"+c+"-"+b.i+"-"+r;g.id="p-"+c+"-"+(b.i+1)+"-"+r;h.id="p-"+c+"-"+(b.i+1)+"-"+(r+1);q.clone();g.clone();h.clone();f.push(new Sticker("s-"+c+"-"+b.i+"-"+2*r,a.color,[q,g,h]));d[f[f.length-1].id]=f[f.length-1];r<t.length-1&&(q=q.clone(),h=h.clone(),k=t[r+1].clone(),
k.id="q-"+c+"-"+b.i+"-"+(r+1),q.clone(),h.clone(),k.clone(),f.push(new Sticker("s-"+c+"-"+b.i+"-"+(2*r+1),a.color,[q,h,k])),d[f[f.length-1].id]=f[f.length-1])}}(u));t=p}e.push(new Face(f))});var l,w,m,n,u,x,v,y;h.forEach(function(c){for(var e={c:0};e.c<b;e={c:e.c},e.c++)l=new Cycle([],3,c.unitVector,a),m=[],c.slices.forEach(function(b){return function(a){var c=$jscomp.makeIterator(a.sIJ(b.c));n=c.next().value;u=c.next().value;y=a.limJ(b.c);for(c=0;c<y;c++){var e=$jscomp.makeIterator(a.dIJ(b.c,c));
x=e.next().value;v=e.next().value;m.push(d["s-"+a.fIndex+"-"+n+"-"+u]);n+=x;u+=v}}}(e)),l.stickerCollections.push(m),f.push(l);c.attachedFaces.forEach(function(a,c){l=c?f[f.length-1]:f[f.length-b];w=a.fIndex;var e=b-1;c=1;for(var q=0,t,r,k;0<e;)r=k=q,m=[],a.steps.forEach(function(b){for(var a=t=0;a<e;a++){var c=$jscomp.makeIterator(b(q,t)),f=c.next().value;c=c.next().value;m.push(d["s-"+w+"-"+r+"-"+k]);r+=f;k+=c;t+=1}}),l.stickerCollections.push(m),q+=1,e-=c,c=2===c?1:2;d["s-"+w+"-"+q+"-"+q]&&l.stickerCollections.push([d["s-"+
w+"-"+q+"-"+q]])})});f.forEach(function(b){b.stickerCollections[0].isPrimary=!0;b.computeStickerCover()});Puzzle.call(this,e,f);this.saveOrientation({axis:new Vector({x:0,y:1,z:0}),angle:Math.PI/12});this.saveOrientation({axis:new Vector({x:1,y:0,z:0}),angle:Math.PI/24})};$jscomp.inherits(Octahedron,Puzzle);
var Dodecahedron=function(b,c){b=void 0===b?1:b;var a=(1+Math.sqrt(5))/2;c=(void 0===c?200:c)/2;var d=c*a;a=1*c/a;var e=[],f=[],h={},l={},w={steps:10,dAlpha:2*Math.PI/5/10};a=[new Point(c,c,c,"r0"),new Point(c,c,-c,"r1"),new Point(c,-c,c,"r2"),new Point(c,-c,-c,"r3"),new Point(-c,c,c,"r4"),new Point(-c,c,-c,"r5"),new Point(-c,-c,c,"r6"),new Point(-c,-c,-c,"r7"),new Point(d,a,0,"r8"),new Point(d,-a,0,"r9"),new Point(-d,a,0,"r10"),new Point(-d,-a,0,"r11"),new Point(0,d,a,"r12"),new Point(0,d,-a,"r13"),
new Point(0,-d,a,"r14"),new Point(0,-d,-a,"r15"),new Point(a,0,d,"r16"),new Point(a,0,-d,"r17"),new Point(-a,0,d,"r18"),new Point(-a,0,-d,"r19")];var m=[{points:[a[8],a[1],a[13],a[12],a[0]],color:"red"},{points:[a[9],a[2],a[14],a[15],a[3]],color:"brown"},{points:[a[10],a[4],a[12],a[13],a[5]],color:"white"},{points:[a[11],a[7],a[15],a[14],a[6]],color:"yellow"},{points:[a[12],a[4],a[18],a[16],a[0]],color:"green"},{points:[a[13],a[1],a[17],a[19],a[5]],color:"blue"},{points:[a[14],a[2],a[16],a[18],a[6]],
color:"pink"},{points:[a[15],a[7],a[19],a[17],a[3]],color:"darkviolet"},{points:[a[16],a[2],a[9],a[8],a[0]],color:"purple"},{points:[a[17],a[1],a[8],a[9],a[3]],color:"lawngreen"},{points:[a[18],a[4],a[10],a[11],a[6]],color:"magenta"},{points:[a[19],a[7],a[11],a[10],a[5]],color:"skyblue"}];a=function(b){return m[b].points.reduce(function(b,a){return b.add(a)},new Vector({x:0,y:0,z:0}))};c=[];for(d=0;12>d;d++){var n={unitVector:a(d),slices:{length:5}},u=void 0;for(u=0;12>u;u++)if(u!=d)for(var x=0;5>
x;x++)for(var v=0;5>v;v++)if(m[d].points[x].id==m[u].points[v].id&&m[d].points[mod(x+1,5)].id==m[u].points[mod(v-1,5)].id){var y=v;var g=mod(v-1,5);n.slices[x]={face:u,startV:y,endV:g}}n.slices=Array.prototype.slice.apply(n.slices);c.push(n)}m.forEach(function(a,c){var d=[];a.points.forEach(function(e,f){var g=new Vector(e),t=(new Vector(e,a.points[mod(f+1,a.points.length)])).multiply(1/(2*b));e=(new Vector(e,a.points[mod(f-1,a.points.length)])).multiply(1/(2*b));var k,p;for(k=0;k<=b;k++)for(p=0;p<=
b;p++){var q=g.add(t.multiply(k)).add(e.multiply(p));h["p-"+c+"-"+f+"-"+k+"-"+p]=new Point(q.x,q.y,q.z);k&&p&&(d.push(new Sticker("s-"+c+"-"+f+"-"+(k-1)+"-"+(p-1),a.color,[h["p-"+c+"-"+f+"-"+k+"-"+p].clone(),h["p-"+c+"-"+f+"-"+(k-1)+"-"+p].clone(),h["p-"+c+"-"+f+"-"+(k-1)+"-"+(p-1)].clone(),h["p-"+c+"-"+f+"-"+k+"-"+(p-1)].clone()])),l[d[d.length-1].id]=d[d.length-1])}q=(new Vector(a.points[mod(f,a.points.length)],a.points[mod(f-1,a.points.length)])).multiply(1/(2*b));p=(new Vector(a.points[mod(f+
1,a.points.length)],a.points[mod(f+2,a.points.length)])).multiply(1/(2*b));var r=g.add(t.multiply(b));for(k=0;k<=b;k++){var m=r.add(q.multiply(k));var n=r.add(p.multiply(k));h["p-m-"+c+"-"+f+"-"+k+"-l"]=new Point(m.x,m.y,m.z);h["p-m-"+c+"-"+f+"-"+k+"-r"]=new Point(n.x,n.y,n.z);k&&(d.push(new Sticker("s-"+c+"-"+f+"-"+(k-1)+"-"+b,a.color,[h["p-m-"+c+"-"+f+"-"+k+"-l"].clone(),h["p-m-"+c+"-"+f+"-"+k+"-r"].clone(),h["p-m-"+c+"-"+f+"-"+(k-1)+"-r"].clone(),h["p-m-"+c+"-"+f+"-"+(k-1)+"-l"].clone()])),l[d[d.length-
1].id]=d[d.length-1])}g=g.add(t.multiply(b)).add(e.multiply(b));h["p-"+c+"-"+f]=new Point(g.x,g.y,g.z)});d.push(new Sticker("s-"+c,a.color,[h["p-"+c+"-0"].clone(),h["p-"+c+"-1"].clone(),h["p-"+c+"-2"].clone(),h["p-"+c+"-3"].clone(),h["p-"+c+"-4"].clone()]));l[d[d.length-1].id]=d[d.length-1];e.push(new Face(d))});c.forEach(function(a,c){for(var d,e={i:0};e.i<b;e={i:e.i,stickerCollection$7:e.stickerCollection$7},e.i++){for(var g=new Cycle([],5,a.unitVector,w),h={j:0};h.j<b;h={stickerCollection:h.stickerCollection,
j:h.j},h.j++)h.stickerCollection=[],a.slices.forEach(function(b,a){return function(c){b.stickerCollection.push(l["s-"+c.face+"-"+c.startV+"-"+a.i+"-"+b.j]);b.stickerCollection.push(l["s-"+c.face+"-"+c.endV+"-"+b.j+"-"+a.i])}}(h,e)),g.stickerCollections.push(h.stickerCollection);e.stickerCollection$7=[];a.slices.forEach(function(a){return function(c){a.stickerCollection$7.push(l["s-"+c.face+"-"+c.endV+"-"+a.i+"-"+b])}}(e));g.stickerCollections.push(e.stickerCollection$7);g.stickerCollections.forEach(function(a){return a.isPrimary=
!0});f.push(g);e.i||(d=g)}for(a=0;a<b;a++)for(e=0;e<=b;e++){g=[];for(h=0;5>h;h++)g.push(l["s-"+c+"-"+h+"-"+a+"-"+e]);d.stickerCollections.push(g)}d.stickerCollections.push([l["s-"+c]])});f.forEach(function(a){return a.computeStickerCover()});Puzzle.call(this,e,f);this.saveOrientation({axis:new Vector({x:1,y:0,z:0}),angle:-Math.PI/5})};$jscomp.inherits(Dodecahedron,Puzzle);
(function(){window.menuConfig={puzzles:{tetrahedron:function(b,a){return new Tetrahedron(b,a?42.5:void 0)},cube:function(b,a){return new Cube(b,a?50:void 0)},octahedron:function(b,a){return new Octahedron(b,a?42.5:void 0)},dodecahedron:function(b,a){return new Dodecahedron(b,a?42.5:void 0)}},sizes:{tetrahedron:[3,4,5],cube:[2,3,4],octahedron:[2,3,4],dodecahedron:[1,2,3]}};var b=0;window.showShapeMenu=function(){b++;window.puzzlemenu.style.display=window.shapemenu.style.display=window.settingsmenubutton.style.display=
"inline-block";window.configurationmenu.style.display=window.puzzlemenubutton.style.display=window.sizemenu.style.display="none";var c=b,a={},d;for(d in window.menuConfig.puzzles)a.elemId=d,a.ctx=window[a.elemId].getContext("2d"),a.puzzle=(0,window.menuConfig.puzzles[a.elemId])(void 0,!0),a.puzzle.updatedOrientation={axis:new Vector({x:1,y:1,z:0}),angle:0},a.ctx.setTransform(1,0,0,1,0,0),a.ctx.translate(50,50),a.loop=function(a){return function(){a.ctx.save();a.ctx.setTransform(1,0,0,1,0,0);a.ctx.clearRect(0,
0,gameCanvas.width,gameCanvas.height);a.ctx.restore();a.puzzle.updatedOrientation.angle+=.015;a.puzzle.update();a.puzzle.render(a.ctx);b==c&&requestAnimationFrame(a.loop)}}(a),requestAnimationFrame(a.loop),window[a.elemId].onmousedown=function(a){return function(){return showSizeMenu(a.elemId)}}(a),a={ctx:a.ctx,puzzle:a.puzzle,loop:a.loop,elemId:a.elemId}};window.showSizeMenu=function(c){b++;var a=b;window.shapemenu.style.display=window.settingsmenubutton.style.display="none";window.sizemenu.style.display=
window.puzzlemenubutton.style.display="inline-block";for(var d={},e=0;3>e;d={ctx:d.ctx,puzzle:d.puzzle,loop:d.loop,constructor:d.constructor,puzzleSize:d.puzzleSize},e++)d.ctx=window["size-"+(e+1)].getContext("2d"),d.constructor=window.menuConfig.puzzles[c],d.puzzleSize=window.menuConfig.sizes[c][e],d.puzzle=d.constructor(d.puzzleSize,!0),d.puzzle.updatedOrientation={axis:new Vector({x:1,y:1,z:0}),angle:0},d.ctx.setTransform(1,0,0,1,0,0),d.ctx.translate(50,50),d.loop=function(c){return function(){c.ctx.save();
c.ctx.setTransform(1,0,0,1,0,0);c.ctx.clearRect(0,0,gameCanvas.width,gameCanvas.height);c.ctx.restore();c.puzzle.updatedOrientation.angle+=.015;c.puzzle.update();c.puzzle.render(c.ctx);b==a&&requestAnimationFrame(c.loop)}}(d),requestAnimationFrame(d.loop),window["size-"+(e+1)].onmousedown=function(a){return function(){window.selectedPuzzle=a.constructor(a.puzzleSize,!1);window.startbutton.style.visibility="visible"}}(d)};window.showSettingsMenu=function(){window.puzzlemenu.style.display=window.settingsmenubutton.style.display=
"none";window.configurationmenu.style.display=window.puzzlemenubutton.style.display="inline-block"};window.showShapeMenu()})();
(function(){var b=gameCanvas.getContext("2d"),c=gameCanvasInverted.getContext("2d");b.translate(300,300);c.scale(1/3,1/3);c.translate(300,300);var a=function(){var a=gameCanvas.getBoundingClientRect();return{x:a.left+300,y:a.top+300}};window.explodedStickers=!0;window.selectedPuzzle=new Tetrahedron;Puzzle.prototype.onFinish=function(a){window.help.style.display="none";window.menu.style.display="none";window.startbutton.style.visibility="visible";window.success.style.display="inline-block";window.message.innerHTML=
"You solved it in "+a+" seconds.\x3cbr/\x3e Good Job."};var d=function(){b.save();b.setTransform(1,0,0,1,0,0);b.clearRect(0,0,gameCanvas.width,gameCanvas.height);b.restore();window.selectedPuzzle.update();window.selectedPuzzle.render(b,!1,window.explodedStickers);window.showRearView&&(c.save(),c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,gameCanvas.width,gameCanvas.height),c.restore(),window.selectedPuzzle.render(c,!0,window.explodedStickers));if(window.selectedPuzzle.startTime){var a=Math.floor(((new Date).getTime()-
window.selectedPuzzle.startTime)/1E3),f=""+Math.floor(a/60);a=""+a%60;2>f.length&&(f="0"+f);2>a.length&&(a="0"+a);window.stats.innerHTML="Time Taken: "+f+":"+a+", Moves Made: "+window.selectedPuzzle.movesMade}else window.stats.innerHTML="Time Taken: --:--, Moves Made: --";requestAnimationFrame(d)};requestAnimationFrame(d);document.addEventListener("contextmenu",function(a){return a.preventDefault()});gameCanvas.addEventListener("mousedown",function(b){b.preventDefault();b.stopPropagation();var c=
a();window.selectedPuzzle.grab(b.clientX-c.x,b.clientY-c.y,b.ctrlKey?2:b.button)});gameCanvas.addEventListener("mousemove",function(b){b.preventDefault();b.stopPropagation();var c=a();window.selectedPuzzle.drag(b.clientX-c.x,b.clientY-c.y)});gameCanvas.addEventListener("mouseup",function(a){a.preventDefault();a.stopPropagation();window.selectedPuzzle.release()});gameCanvas.addEventListener("mouseleave",function(a){window.selectedPuzzle.release()})})();
