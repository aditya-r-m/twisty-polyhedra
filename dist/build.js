var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(b.call(c,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");var origin={x:0,y:0,z:0},Vector=function(a,b){b||(b=a,a=origin);this.x=b.x-a.x;this.y=b.y-a.y;this.z=b.z-a.z};Vector.prototype.add=function(a){return new Vector(origin,{x:this.x+a.x,y:this.y+a.y,z:this.z+a.z})};Vector.prototype.subtract=function(a){return this.add({x:-a.x,y:-a.y,z:-a.z})};
Vector.prototype.multiply=function(a){return new Vector(origin,{x:this.x*a,y:this.y*a,z:this.z*a})};Vector.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};Vector.prototype.unit=function(){return this.multiply(1/this.magnitude())};Vector.prototype.cross=function(a){return new Vector(origin,{x:this.y*a.z-this.z*a.y,y:this.z*a.x-this.x*a.z,z:this.x*a.y-this.y*a.x})};
var qDimensions=["w","x","y","z"],qProductSign=[[1,1,1,1],[1,-1,1,-1],[1,-1,-1,1],[1,1,-1,-1]],qProductAxis=[[0,1,2,3],[1,0,3,2],[2,3,0,1],[3,2,1,0]],Quaternion=function(a,b,c,d){this.w=a;this.x=b;this.y=c;this.z=d};Quaternion.prototype.conjugate=function(){return new Quaternion(this.w,-this.x,-this.y,-this.z)};
Quaternion.prototype.multiply=function(a){for(var b=new Quaternion(0,0,0,0),c=0;4>c;c++)for(var d=0;4>d;d++)b[qDimensions[qProductAxis[c][d]]]+=qProductSign[c][d]*this[qDimensions[c]]*a[qDimensions[d]];return b};var Point=function(a,b,c,d){this.base={x:a,y:b,z:c};this.x=a;this.y=b;this.z=c;this.id=d};Point.prototype.update=function(a){a=this.rotateAroundAxis(this.base,a.axis.unit(),a.angle);var b=a.y,c=a.z;this.x=a.x;this.y=b;this.z=c};
Point.prototype.saveOrientation=function(a){this.update(a);this.base.x=this.x;this.base.y=this.y;this.base.z=this.z};Point.prototype.clone=function(){return new Point(this.x,this.y,this.z,this.id)};Point.prototype.rotateAroundAxis=function(a,b,c){var d=Math.sin(c/2);b=new Quaternion(Math.cos(c/2),d*b.x,d*b.y,d*b.z);a=new Quaternion(0,a.x,a.y,a.z);a=b.multiply(a).multiply(b.conjugate());return new Point(a.x,a.y,a.z)};var Sticker=function(a,b,c){this.id=a;this.color=b;this.points=c;this.attractor={}};
Sticker.prototype.contains=function(a){for(var b=this.points[this.points.length-1],c=0,d=$jscomp.makeIterator(this.points),e=d.next();!e.done;e=d.next()){e=e.value;b=(new Vector(b,e)).cross(new Vector(b,a));if(0>c&&0<b.z||0<c&&0>b.z)return!1;0!==b.z&&(c=b.z);b=e}return!0};Sticker.prototype.calculateNormalVector=function(){return(new Vector(this.points[0],this.points[1])).cross(new Vector(this.points[0],this.points[this.points.length-1]))};
Sticker.prototype.update=function(a){this.points.forEach(function(b){return b.update(a)});this.attractor={x:this.points.reduce(function(a,c){return a+c.x},0),y:this.points.reduce(function(a,c){return a+c.y},0),z:this.points.reduce(function(a,c){return a+c.z},0)}};Sticker.prototype.getPointProjection=function(a,b,c){a=[a.x,a.y];c&&(a[0]+=this.attractor.x-a[0]>>5,a[1]+=this.attractor.y-a[1]>>5);b&&(a[0]=-a[0]);return a};
Sticker.prototype.render=function(a,b,c){var d=this;a.fillStyle=this.color;a.strokeStyle="#202020";a.beginPath();a.moveTo.apply(a,$jscomp.arrayFromIterable(this.getPointProjection(this.points[0],b,c)));this.points.forEach(function(e){return a.lineTo.apply(a,$jscomp.arrayFromIterable(d.getPointProjection(e,b,c)))});a.closePath();a.fill();a.stroke()};var Face=function(a){this.stickers=a;this.normalVector=this.stickers[0].calculateNormalVector()};
Face.prototype.update=function(a){this.stickers.forEach(function(b){return b.update(a)});this.normalVector=this.stickers[0].calculateNormalVector()};Face.prototype.render=function(a,b,c){this.stickers.forEach(function(d){return d.render(a,b,c)})};var Cycle=function(a,b,c,d){this.stickerCollections=a;this.period=b;this.unitVector=c;this.animationConfig=d;this.stickerCover={}};
Cycle.prototype.computeStickerCover=function(){var a=this;this.stickerCollections.forEach(function(b){return b.forEach(function(b){return a.stickerCover[b.id]=!0})})};Cycle.prototype.saveOrientation=function(a){var b=new Point(this.unitVector.x,this.unitVector.y,this.unitVector.z);b.update(a);this.unitVector=new Vector(b)};Cycle.prototype.mod=function(a,b){return(a%b+b)%b};
Cycle.prototype.twist=function(a){var b=this;a=void 0===a?1:a;this.stickerCollections.forEach(function(c){if(1!==c.length){var d=a*c.length/b.period;c.forEach(function(a,g){a.newColor=c[b.mod(g-d,c.length)].color});c.forEach(function(a){a.color=a.newColor;delete a.newColor})}})};
var Puzzle=function(a,b){this.faces=a;this.cycles=b;this.twisting=this.rotating=!1;this.startEvtCoordinates={};this.baseOrientation={axis:new Vector({x:1,y:0,z:0}),angle:0};this.twistCounter=0;this.animationState={active:!1,counter:0,direction:void 0,cycle:void 0};this.stickers=[].concat.apply([],$jscomp.arrayFromIterable(this.faces.map(function(a){return a.stickers})));this.startTime=void 0;this.movesMade=0;this.cycleMap={};this.processCycleMap();this.startSticker=void 0};
Puzzle.prototype.isSolved=function(){for(var a=0;a<this.faces.length;a++)for(var b=0;b<this.faces[a].stickers.length;b++)if(this.faces[a].stickers[b].color!==this.faces[a].stickers[0].color)return!1;return!0};Puzzle.prototype.processCycleMap=function(){var a=this;this.cycles.forEach(function(b){return b.stickerCollections[0].forEach(function(c){a.cycleMap[c.id]=a.cycleMap[c.id]||[];a.cycleMap[c.id].push(b)})})};
Puzzle.prototype.update=function(){var a=this;if(this.animationState.active&&this.animationState.counter<this.animationState.cycle.animationConfig.steps){var b={axis:this.animationState.cycle.unitVector,angle:this.animationState.direction*this.animationState.counter*this.animationState.cycle.animationConfig.dAlpha};this.stickers.forEach(function(c){a.animationState.cycle.stickerCover[c.id]&&c.update(b)});this.stickers.sort(function(a,b){return b.attractor.z-a.attractor.z});this.animationState.counter++}else if(this.faces.forEach(function(b){return b.update(a.updatedOrientation||
a.baseOrientation)}),this.faces.sort(function(a,b){return b.normalVector.z-a.normalVector.z}),this.animationState.active){this.animationState.cycle.twist(this.animationState.direction);this.startTime&&this.isSolved()?(this.onFinish&&this.onFinish(((new Date).getTime()-this.startTime)/1E3),this.startTime=void 0,this.movesMade=0):this.startTime&&this.movesMade++;if(this.animationState.callback&&(this.animationState.callback(),this.animationState.counter<this.animationState.cycle.animationConfig.steps))return this.update();
this.animationState={active:!1,counter:0,direction:void 0,cycle:void 0}}};Puzzle.prototype.findTouchedSticker=function(a,b){for(var c,d=this.faces.length-1;0<=d&&!(0<=this.faces[d].normalVector.z);d--)if(c=this.faces[d].stickers.find(function(c){return c.contains({x:a,y:b,z:0})}))return c};Puzzle.prototype.grab=function(a,b,c){this.startEvtCoordinates.x=a;this.startEvtCoordinates.y=b;2==c?this.rotating=!0:(this.startSticker=this.findTouchedSticker(a,b),this.twisting=!!this.startSticker)};
Puzzle.prototype.drag=function(a,b){if(!this.animationState.active)if(this.rotating){if(a=(a-this.startEvtCoordinates.x)/100,b=(b-this.startEvtCoordinates.y)/100,a||b)b=new Vector({x:b,y:-a,z:0}),this.updatedOrientation={axis:b,angle:b.magnitude()}}else this.twisting&&(9>this.twistCounter?this.twistCounter++:this.detectCycle(a,b))};
Puzzle.prototype.detectCycle=function(a,b){var c=new Vector(new Point(this.startEvtCoordinates.x,this.startEvtCoordinates.y,0),new Point(a,b,0)),d=0,e,g;this.cycleMap[this.startSticker.id].forEach(function(a){var b=new Point(a.unitVector.x,a.unitVector.y,a.unitVector.z);b.z=0;b=(new Vector(b)).unit();b=c.cross(b);d<b.magnitude()&&(d=b.magnitude(),e=a,g=0<b.z?-1:1)});this.animationState={active:!0,counter:0,direction:g,cycle:e};this.release()};
Puzzle.prototype.release=function(){this.twisting=this.rotating=!1;this.startEvtCoordinates={};this.updatedOrientation&&(this.saveOrientation(this.updatedOrientation),this.updatedOrientation=void 0);this.twistCounter=0;this.startSticker=void 0};Puzzle.prototype.saveOrientation=function(a){this.stickers.forEach(function(b){return b.points.forEach(function(b){return b.saveOrientation(a)})});this.cycles.forEach(function(b){return b.saveOrientation(a)})};
Puzzle.prototype.scramble=function(){for(var a=this,b=3*this.cycles.length,c=[],d=0;d<b;d++)c.push({cycle:this.cycles[Math.floor(Math.random()*this.cycles.length)],direction:.5>Math.random()?-1:1});var e=[];c.forEach(function(d,k){var g=d.cycle;d=d.direction;k&&g===c[k-1].cycle&&(d=c[k-1].direction);e.push({active:!0,counter:0,direction:d,cycle:g,callback:k<b-1?function(){return a.animationState=e[k+1]}:function(){return a.startTime=(new Date).getTime()}})});this.animationState=e[0]};
Puzzle.prototype.render=function(a,b,c){c=void 0===c?!0:c;if(this.animationState.active){var d=$jscomp.makeIterator(b?[this.stickers.length-1,-1,-1]:[0,this.stickers.length,1]),e=d.next().value,g=d.next().value;for(d=d.next().value;e!==g;e+=d)this.stickers[e].render(a,b,c)}else for(d=$jscomp.makeIterator(b?[this.faces.length-1,-1,-1]:[0,this.faces.length,1]),e=d.next().value,g=d.next().value,d=d.next().value;e!==g;e+=d)this.faces[e].render(a,b,c)};
var Cube=function(a,b){a=void 0===a?2:a;b=void 0===b?250:b;var c=b/a,d=b/2,e={steps:10,dAlpha:Math.PI/2/10},g={},k=[];b=[{slices:[{fIndex:1,sIndex:0,sJump:a,cJump:1},{fIndex:3,sIndex:a-1,sJump:-1,cJump:a},{fIndex:0,sIndex:(a-1)*a,sJump:-a,cJump:1},{fIndex:2,sIndex:0,sJump:1,cJump:a}],attachedFaces:{ffIndex:4,lfIndex:5,iStep:a,jStep:1},unitVector:new Vector(new Point(0,0,1))},{slices:[{fIndex:1,sIndex:0,sJump:1,cJump:a},{fIndex:5,sIndex:(a-1)*a,sJump:-a,cJump:1},{fIndex:0,sIndex:a-1,sJump:-1,cJump:a},
{fIndex:4,sIndex:0,sJump:a,cJump:1}],attachedFaces:{ffIndex:2,lfIndex:3,iStep:1,jStep:a},unitVector:new Vector(new Point(0,-1,0))},{slices:[{fIndex:2,sIndex:0,sJump:a,cJump:1},{fIndex:5,sIndex:0,sJump:1,cJump:a},{fIndex:3,sIndex:(a-1)*a,sJump:-a,cJump:1},{fIndex:4,sIndex:a-1,sJump:-1,cJump:a}],attachedFaces:{ffIndex:0,lfIndex:1,iStep:1,jStep:a},unitVector:new Vector(new Point(-1,0,0))}];var B=[{key:"iStep",dir:1},{key:"jStep",dir:1},{key:"iStep",dir:-1},{key:"jStep",dir:-1}],q,u,f,y,A,C;[{fixed:"x",
direction:-1,variable:["y","z"],color:"yellow"},{fixed:"x",direction:1,variable:["y","z"],color:"white"},{fixed:"y",direction:-1,variable:["z","x"],color:"blue"},{fixed:"y",direction:1,variable:["z","x"],color:"lawngreen"},{fixed:"z",direction:-1,variable:["x","y"],color:"red"},{fixed:"z",direction:1,variable:["x","y"],color:"darkorange"}].forEach(function(b,h){var e=[];q=-d;for(var m=0;m<=a;m++){u=-d;for(var l=0;l<=a;l++)y="p-"+h+"-"+m+"-"+l,f={},f[b.fixed]=b.direction*d,f[b.variable[0]]=q,f[b.variable[1]]=
u,g[y]=new Point(f.x,f.y,f.z,y),m&&l&&(A="s-"+h+"-"+m+"-"+l,C=[g["p-"+h+"-"+m+"-"+l].clone(),g["p-"+h+"-"+(m-1)+"-"+l].clone(),g["p-"+h+"-"+(m-1)+"-"+(l-1)].clone(),g["p-"+h+"-"+m+"-"+(l-1)].clone()],-1===b.direction&&C.reverse(),e.push(new Sticker(A,b.color,C))),u+=c;q+=c}k.push(new Face(e))});var x=[],t,h,m,z,w,p,n;b.forEach(function(b){for(var c={c:0};c.c<a;c={c:c.c},c.c++)t=new Cycle([],4,b.unitVector,e),h=[],b.slices.forEach(function(b){return function(c){for(var d=0;d<a;d++)m=c.sIndex+d*c.sJump+
b.c*c.cJump,h.push(k[c.fIndex].stickers[m])}}(c)),t.stickerCollections.push(h),x.push(t);z=x[x.length-a];p=k[b.attachedFaces.ffIndex];for(c={c$4:0};c.c$4<Math.floor(a/2);c={c$4:c.c$4},c.c$4++)h=[],m=c.c$4*(a+1),B.forEach(function(c){return function(d){var e=d.key;d=d.dir;for(var t=0;t<a-2*c.c$4-1;t++)h.push(p.stickers[m]),m+=b.attachedFaces[e]*d}}(c)),z.stickerCollections.push(h);w=x[x.length-1];n=k[b.attachedFaces.lfIndex];for(c={c$5:0};c.c$5<Math.floor(a/2);c={c$5:c.c$5},c.c$5++)h=[],m=c.c$5*(a+
1),B.forEach(function(c){return function(d){var e=d.key;d=d.dir;for(var t=0;t<a-2*c.c$5-1;t++)h.push(n.stickers[m]),m+=b.attachedFaces[e]*d}}(c)),w.stickerCollections.push(h);a%2&&(z.stickerCollections.push([p.stickers[(a*a-1)/2]]),w.stickerCollections.push([n.stickers[(a*a-1)/2]]));x.forEach(function(a){return a.computeStickerCover()})});Puzzle.call(this,k,x);this.saveOrientation({axis:new Vector({x:0,y:1,z:0}),angle:Math.PI/4});this.saveOrientation({axis:new Vector({x:1,y:0,z:0}),angle:Math.PI/
8})};$jscomp.inherits(Cube,Puzzle);
var Tetrahedron=function(a,b){a=void 0===a?3:a;b=void 0===b?200:b;var c=b/Math.sqrt(2),d={steps:10,dAlpha:2*Math.PI/3/10},e={},g={},k=[],B=[];c=[new Point(b,0,c),new Point(-b,0,c),new Point(0,b,-c),new Point(0,-b,-c)];b=[{points:[c[0],c[2],c[1]],color:"white"},{points:[c[0],c[1],c[3]],color:"blue"},{points:[c[0],c[3],c[2]],color:"lawngreen"},{points:[c[1],c[2],c[3]],color:"red"}];c=[{slices:[{fIndex:0,sIJ:function(a){return[a,0]},dIJ:function(){return[0,1]}},{fIndex:1,sIJ:function(a){return[a,0]},
dIJ:function(){return[0,1]}},{fIndex:2,sIJ:function(a){return[a,0]},dIJ:function(){return[0,1]}}],attachedFace:{fIndex:3,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(c[0])).unit()},{slices:[{fIndex:0,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]}},{fIndex:3,sIJ:function(a){return[a,0]},dIJ:function(){return[0,1]}},{fIndex:1,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]}}],attachedFace:{fIndex:2,
steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(c[1])).unit()},{slices:[{fIndex:0,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]}},{fIndex:2,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]}},{fIndex:3,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]}}],attachedFace:{fIndex:1,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(c[2])).unit()},
{slices:[{fIndex:1,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]}},{fIndex:3,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]}},{fIndex:2,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]}}],attachedFace:{fIndex:0,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]},unitVector:(new Vector(c[3])).unit()}];b.forEach(function(b,c){for(var h=[],d=[b.points[0].clone()],w,p,n,r,l,
D=(new Vector(b.points[0],b.points[1])).multiply(1/a),q=(new Vector(b.points[1],b.points[2])).multiply(1/a),f,v={i:0};v.i<a;v={i:v.i},v.i++){w=[];f=D.add(d[0]);w.push(new Point(f.x,f.y,f.z));for(var t=0;t<=v.i;t++)f=q.add(f),w.push(new Point(f.x,f.y,f.z));d.forEach(function(a){return function(m,f){p=m.clone();n=w[f].clone();r=w[f+1].clone();for(p.id="p-"+c+"-"+a.i+"-"+f;e[p.id];)p.id+="-n";for(n.id="p-"+c+"-"+(a.i+1)+"-"+f;e[n.id];)n.id+="-n";for(r.id="p-"+c+"-"+(a.i+1)+"-"+(f+1);e[r.id];)r.id+="-n";
e[p.id]=p.clone();e[n.id]=n.clone();e[r.id]=r.clone();h.push(new Sticker("s-"+c+"-"+a.i+"-"+2*f,b.color,[p,n,r]));g[h[h.length-1].id]=h[h.length-1];if(f<d.length-1){for(p=p.clone();e[p.id];)p.id+="-n";for(r=r.clone();e[r.id];)r.id+="-n";l=d[f+1].clone();for(l.id="q-"+c+"-"+a.i+"-"+(f+1);e[l.id];)l.id+="-n";e[p.id]=p.clone();e[r.id]=r.clone();e[l.id]=l.clone();h.push(new Sticker("s-"+c+"-"+a.i+"-"+(2*f+1),b.color,[p,r,l]));g[h[h.length-1].id]=h[h.length-1]}}}(v));d=w}k.push(new Face(h))});var q,u,
f,y,A,C,x;c.forEach(function(b){for(var c={c:0};c.c<a;c={c:c.c},c.c++)q=new Cycle([],3,b.unitVector,d),f=[],b.slices.forEach(function(a){return function(b){var c=$jscomp.makeIterator(b.sIJ(a.c));y=c.next().value;A=c.next().value;for(c=0;c<1+2*a.c;c++){var h=$jscomp.makeIterator(b.dIJ(a.c,c));C=h.next().value;x=h.next().value;f.push(g["s-"+b.fIndex+"-"+y+"-"+A]);y+=C;A+=x}}}(c)),q.stickerCollections.push(f),B.push(q),q.computeStickerCover();q=B[B.length-1];u=b.attachedFace.fIndex;var e=a-1;c=1;for(var z=
0,w,p,n;0<e;)p=n=z,f=[],b.attachedFace.steps.forEach(function(a){for(var b=w=0;b<e;b++){var c=$jscomp.makeIterator(a(z,w)),h=c.next().value;c=c.next().value;f.push(g["s-"+u+"-"+p+"-"+n]);p+=h;n+=c;w+=1}}),q.stickerCollections.push(f),z+=1,e-=c,c=2===c?1:2;g["s-"+u+"-"+z+"-"+z]&&q.stickerCollections.push([g["s-"+u+"-"+z+"-"+z]]);q.computeStickerCover()});Puzzle.call(this,k,B);this.saveOrientation({axis:new Vector({x:0,y:1,z:0}),angle:Math.PI/3})};$jscomp.inherits(Tetrahedron,Puzzle);
var Octahedron=function(a,b){a=void 0===a?3:a;b=void 0===b?200:b;var c={steps:10,dAlpha:2*Math.PI/3/10},d={},e={},g=[],k=[];b=[new Point(0,0,-b),new Point(b,0,0),new Point(0,b,0),new Point(-b,0,0),new Point(0,-b,0),new Point(0,0,b)];b=[{points:[b[0],b[2],b[1]],color:"white"},{points:[b[0],b[1],b[4]],color:"blue"},{points:[b[0],b[4],b[3]],color:"lawngreen"},{points:[b[0],b[3],b[2]],color:"skyblue"},{points:[b[5],b[1],b[2]],color:"red"},{points:[b[5],b[2],b[3]],color:"darkorange"},{points:[b[5],b[3],
b[4]],color:"purple"},{points:[b[5],b[4],b[1]],color:"yellow"}];var B=[{slices:[{fIndex:4,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(){return[0,-1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:7,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]},limJ:function(a){return 1+2*a}},{fIndex:1,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,b%2?-1:1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:2,sIJ:function(a){return[a,0]},dIJ:function(){return[0,
1]},limJ:function(a){return 1+2*a}},{fIndex:3,sIJ:function(a){return[a,0]},dIJ:function(a,b){return[b%2?0:1,1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:5,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]},limJ:function(a){return 1+2*a}}],attachedFaces:[{fIndex:0,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:6,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(1,
1,-1))).unit()},{slices:[{fIndex:0,sIJ:function(a){return[a,0]},dIJ:function(a,b){return[b%2?0:1,1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:4,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]},limJ:function(a){return 1+2*a}},{fIndex:7,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(){return[0,-1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:6,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]},limJ:function(a){return 1+2*a}},{fIndex:2,
sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,b%2?-1:1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:3,sIJ:function(a){return[a,0]},dIJ:function(){return[0,1]},limJ:function(a){return 1+2*a}}],attachedFaces:[{fIndex:1,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:5,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(1,-1,-1))).unit()},{slices:[{fIndex:1,sIJ:function(a){return[a,
0]},dIJ:function(a,b){return[b%2?0:1,1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:7,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]},limJ:function(a){return 1+2*a}},{fIndex:6,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(){return[0,-1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:5,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]},limJ:function(a){return 1+2*a}},{fIndex:3,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%
2?-1:0,b%2?-1:1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:0,sIJ:function(a){return[a,0]},dIJ:function(){return[0,1]},limJ:function(a){return 1+2*a}}],attachedFaces:[{fIndex:2,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:4,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(-1,-1,-1))).unit()},{slices:[{fIndex:2,sIJ:function(a){return[a,0]},dIJ:function(a,b){return[b%2?0:1,1]},limJ:function(b){return 1+
2*(a-b-1)}},{fIndex:6,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,-1]},limJ:function(a){return 1+2*a}},{fIndex:5,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(){return[0,-1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:4,sIJ:function(b){return[a-b-1,2*(a-b-1)]},dIJ:function(a,b){return[b%2?0:1,b%2?-1:1]},limJ:function(a){return 1+2*a}},{fIndex:0,sIJ:function(b){return[a-1,2*b]},dIJ:function(a,b){return[b%2?-1:0,b%2?-1:1]},limJ:function(b){return 1+2*(a-b-1)}},{fIndex:1,
sIJ:function(a){return[a,0]},dIJ:function(){return[0,1]},limJ:function(a){return 1+2*a}}],attachedFaces:[{fIndex:3,steps:[function(){return[1,0]},function(){return[0,2]},function(){return[-1,-2]}]},{fIndex:7,steps:[function(){return[1,2]},function(){return[0,-2]},function(){return[-1,0]}]}],unitVector:(new Vector(new Point(-1,1,-1))).unit()}];b.forEach(function(b,c){for(var f=[],h=[b.points[0].clone()],p,n,r,l,m,k=(new Vector(b.points[0],b.points[1])).multiply(1/a),q=(new Vector(b.points[1],b.points[2])).multiply(1/
a),v,t={i:0};t.i<a;t={i:t.i},t.i++){p=[];v=k.add(h[0]);p.push(new Point(v.x,v.y,v.z));for(var u=0;u<=t.i;u++)v=q.add(v),p.push(new Point(v.x,v.y,v.z));h.forEach(function(a){return function(g,k){n=g.clone();r=p[k].clone();l=p[k+1].clone();for(n.id="p-"+c+"-"+a.i+"-"+k;d[n.id];)n.id+="-n";for(r.id="p-"+c+"-"+(a.i+1)+"-"+k;d[r.id];)r.id+="-n";for(l.id="p-"+c+"-"+(a.i+1)+"-"+(k+1);d[l.id];)l.id+="-n";d[n.id]=n.clone();d[r.id]=r.clone();d[l.id]=l.clone();f.push(new Sticker("s-"+c+"-"+a.i+"-"+2*k,b.color,
[n,r,l]));e[f[f.length-1].id]=f[f.length-1];if(k<h.length-1){for(n=n.clone();d[n.id];)n.id+="-n";for(l=l.clone();d[l.id];)l.id+="-n";m=h[k+1].clone();for(m.id="q-"+c+"-"+a.i+"-"+(k+1);d[m.id];)m.id+="-n";d[n.id]=n.clone();d[l.id]=l.clone();d[m.id]=m.clone();f.push(new Sticker("s-"+c+"-"+a.i+"-"+(2*k+1),b.color,[n,l,m]));e[f[f.length-1].id]=f[f.length-1]}}}(t));h=p}g.push(new Face(f))});var q,u,f,y,A,C,x,t;B.forEach(function(b){for(var d={c:0};d.c<a;d={c:d.c},d.c++)q=new Cycle([],3,b.unitVector,c),
f=[],b.slices.forEach(function(a){return function(b){var c=$jscomp.makeIterator(b.sIJ(a.c));y=c.next().value;A=c.next().value;t=b.limJ(a.c);for(c=0;c<t;c++){var d=$jscomp.makeIterator(b.dIJ(a.c,c));C=d.next().value;x=d.next().value;f.push(e["s-"+b.fIndex+"-"+y+"-"+A]);y+=C;A+=x}}}(d)),q.stickerCollections.push(f),k.push(q),q.computeStickerCover();b.attachedFaces.forEach(function(b,c){q=c?k[k.length-1]:k[k.length-a];u=b.fIndex;var d=a-1;c=1;for(var g=0,h,l,m;0<d;)l=m=g,f=[],b.steps.forEach(function(a){for(var b=
h=0;b<d;b++){var c=$jscomp.makeIterator(a(g,h)),k=c.next().value;c=c.next().value;f.push(e["s-"+u+"-"+l+"-"+m]);l+=k;m+=c;h+=1}}),q.stickerCollections.push(f),g+=1,d-=c,c=2===c?1:2;e["s-"+u+"-"+g+"-"+g]&&q.stickerCollections.push([e["s-"+u+"-"+g+"-"+g]]);q.computeStickerCover()})});Puzzle.call(this,g,k);this.saveOrientation({axis:new Vector({x:0,y:1,z:0}),angle:Math.PI/12});this.saveOrientation({axis:new Vector({x:1,y:0,z:0}),angle:Math.PI/24})};$jscomp.inherits(Octahedron,Puzzle);
(function(){window.menuConfig={puzzles:[]};for(var a={i:2};4>=a.i;a={i:a.i},a.i++)window.menuConfig.puzzles.push({elem:window["menu-1-item-"+(a.i-1)],create:function(a){return function(b){return new Cube(a.i,b?50:void 0)}}(a)});for(a={i$7:3};5>=a.i$7;a={i$7:a.i$7},a.i$7++)window.menuConfig.puzzles.push({elem:window["menu-2-item-"+(a.i$7-2)],create:function(a){return function(b){return new Tetrahedron(a.i$7,b?40:void 0)}}(a)});for(a={i$8:2};4>=a.i$8;a={i$8:a.i$8},a.i$8++)window.menuConfig.puzzles.push({elem:window["menu-3-item-"+
(a.i$8-1)],create:function(a){return function(b){return new Octahedron(a.i$8,b?40:void 0)}}(a)});window.menuConfig.puzzles.forEach(function(a){var b=a.elem,d=a.create,e=b.getContext("2d"),g=d(!0);g.updatedOrientation={axis:new Vector({x:1,y:1,z:0}),angle:0};e.translate(50,50);var k=function(){e.save();e.setTransform(1,0,0,1,0,0);e.clearRect(0,0,gameCanvas.width,gameCanvas.height);e.restore();g.updatedOrientation.angle+=.015;g.update();g.render(e);requestAnimationFrame(k)};requestAnimationFrame(k);
b.onmousedown=function(){window.selectedPuzzle=d();window.startbutton.style.visibility="visible"}})})();
(function(){var a=gameCanvas.getContext("2d"),b=gameCanvasInverted.getContext("2d");a.translate(300,300);b.scale(1/3,1/3);b.translate(300,300);var c=function(){var a=gameCanvas.getBoundingClientRect();return{x:a.left+300,y:a.top+300}};window.explodedStickers=!0;window.selectedPuzzle=new Tetrahedron(3);Puzzle.prototype.onFinish=function(a){window.help.style.display="none";window.menu.style.display="none";window.startbutton.style.visibility="visible";window.success.style.display="inline-block";window.message.innerHTML=
"You solved it in "+a+" seconds.\x3cbr/\x3e Good Job."};var d=function(){a.save();a.setTransform(1,0,0,1,0,0);a.clearRect(0,0,gameCanvas.width,gameCanvas.height);a.restore();window.selectedPuzzle.update();window.selectedPuzzle.render(a,!1,window.explodedStickers);window.showRearView&&(b.save(),b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,gameCanvas.width,gameCanvas.height),b.restore(),window.selectedPuzzle.render(b,!0,window.explodedStickers));if(window.selectedPuzzle.startTime){var c=Math.floor(((new Date).getTime()-
window.selectedPuzzle.startTime)/1E3),g=""+Math.floor(c/60);c=""+c%60;2>g.length&&(g="0"+g);2>c.length&&(c="0"+c);window.stats.innerHTML="Time Taken: "+g+":"+c+", Moves Made: "+window.selectedPuzzle.movesMade}else window.stats.innerHTML="Time Taken: --:--, Moves Made: --";requestAnimationFrame(d)};requestAnimationFrame(d);document.addEventListener("contextmenu",function(a){return a.preventDefault()});gameCanvas.addEventListener("mousedown",function(a){a.preventDefault();a.stopPropagation();var b=
c();window.selectedPuzzle.grab(a.clientX-b.x,a.clientY-b.y,a.ctrlKey?2:a.button)});gameCanvas.addEventListener("mousemove",function(a){a.preventDefault();a.stopPropagation();var b=c();window.selectedPuzzle.drag(a.clientX-b.x,a.clientY-b.y)});gameCanvas.addEventListener("mouseup",function(a){a.preventDefault();a.stopPropagation();window.selectedPuzzle.release()});gameCanvas.addEventListener("mouseleave",function(a){window.selectedPuzzle.release()})})();
